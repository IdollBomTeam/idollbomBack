<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" th:href="@{/css/main/index_parents.css}">
    <link rel="stylesheet" th:href="@{/css/layout/header.css}">
    <link rel="stylesheet" th:href="@{/css/layout/footer.css}">
    <title>부모 메인</title>
</head>



<body>

    <!-- 헤더 -->
    <div th:replace="~{/layout/header_parents :: header_parents}"></div>

    <div id="container">
        <!-- 부모 메인페이지 비쥬얼 이미지 -->
        <section class="visual">
            <div>
                <img th:src="@{/images/main_visual-rebranded.webp}">
            </div>
        </section>

        <!-- 자동매칭 바로가기 -->
        <section class="matching">
            <h2>자동매칭</h2>
            <div class="matching_wrap">
                <img th:src="@{/images/index_matching.jpg}">
                <div>
                    <p>
                        돌봄과 배움을 함께, 우리아이 단짝쌤 찾기 <br>
                        아이에게 필요한 모든것을 추천합니다.
                    </p>
                    <a class="login" th:href="@{/match}" sec:authorize="isAuthenticated()">자세히 보기<span>+</span></a>
                    <a class="check" sec:authorize="!isAuthenticated()">자세히 보기<span>+</span></a>
                </div>
            </div>
        </section>

        <!-- 전문가 추천 리스트 전문가 클릭 시 수업 상세 페이지로 이동 -->
        <section class="pro_recommendation">
            <div>
                <h2>전문가 추천</h2>
                <a href="#">더보기<span>+</span></a>
            </div>
            <ul>
                <li>
                    <a href="#">
                        <img th:src="@{/images/index_recommendation.png}">
                        <p>유가람</p>
                        <div>
                            <p>후기</p>
                            <img src="../../images/4.5rating.png">
                            <p>(97)</p>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="../../images/index_recommendation.png">
                        <p>유가람</p>
                        <div>
                            <p>후기</p>
                            <img src="../../images/4.5rating.png">
                            <p>(97)</p>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="../../images/index_recommendation.png">
                        <p>유가람</p>
                        <div>
                            <p>후기</p>
                            <img src="../../images/4.5rating.png">
                            <p>(97)</p>
                        </div>
                    </a>
                </li>
            </ul>
            <div class="pro_control">
    <!--            <button type="button" id="prev"><img th:src="@{/images/pro_button_pre.png}" alt="이전 메뉴 보기"></button>-->
    <!--            <button type="button" id="next"><img th:src="@{/images/pro_button_next.png}" alt="다음 메뉴 보기"></button>-->
            </div>
        </section>

        <!-- 키즈존 추천 예약하기 클릭 시 네이버 지도로 이동 -->
        <section class="kids">
            <h2>키즈존 추천</h2>
            <ul>
                <li>
                    <img th:src="@{/images/kids1.jpg}">
                    <div>
                        <p>[공덕 프론트원] 자란다 키즈존</p>
                        <p>프론트원은 110개의 스타트업이 모여있는 세계 최대 스타트업 공간입니다.</p>
                        <p><b>위치</b>서울특별시 마포구 마포대로 122 1층</p>
                        <p><b>이용 연령</b>4세 ~ 13세(일반인 이용가능)</p>
                        <p><b>이용 시간</b>평일 9:00 ~ 19:00</p>
                        <p><a href="#">키즈존 예약하기</a></p>
                    </div>
                </li>
                <li>
                    <img th:src="@{/images/kids2.jpg}">
                    <div>
                        <p>[역삼 마루 360] 자란다 키즈존</p>
                        <p>강남 창업가 거리에 위치한 MARU는 기업가 정신을 실천하고 확산하는 사람들을 위한 공간입니다.</p>
                        <p><b>위치</b>서울특별시 강남구 역삼로 172 2층</p>
                        <p><b>이용 연령</b>4세 ~ 13세(일반인 이용가능)</p>
                        <p><b>이용 시간</b>평일 9:00 ~ 19:00</p>
                        <p><a href="#">키즈존 예약하기</a></p>
                    </div>
                </li>
            </ul>
        </section>

        <!-- 모든 수업 리스트 클릭 시 수업신청 목록 페이지로 이동 -->
        <section class="category">
            <h2>모든수업</h2>
            <ul>
                <li>
                    <div>
                        <p>돌봄</p>
                        <ul>
                            <li><a th:href="@{/class/classcare}">등/하원</a></li>
                            <li><a th:href="@{/class/classcare}">실내놀이</a></li>
                            <li><a th:href="@{/class/classcare}">책읽기</a></li>
                            <li><a th:href="@{/class/classcare}">놀이터</a></li>
                            <li><a th:href="@{/class/classcare}">견학/체험</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div>
                        <p>교육</p>
                        <ul>
                            <li><a th:href="@{/class/classstudy}">초등국어</a></li>
                            <li><a th:href="@{/class/classstudy}">초등영어</a></li>
                            <li><a th:href="@{/class/classstudy}">초등수학</a></li>
                            <li><a th:href="@{/class/classstudy}">코딩</a></li>
                            <li><a th:href="@{/class/classstudy}">초등과학</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div>
                        <p>운동</p>
                        <ul>
                            <li><a th:href="@{/class/classsport}">축구</a></li>
                            <li><a th:href="@{/class/classsport}">줄넘기</a></li>
                            <li><a th:href="@{/class/classsport}">배드민턴</a></li>
                            <li><a th:href="@{/class/classsport}">자전거</a></li>
                            <li><a th:href="@{/class/classsport}">야구</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div>
                        <p>예능</p>
                        <ul>
                            <li><a th:href="@{/class/classentertaionment}">그리기</a></li>
                            <li><a th:href="@{/class/classentertaionment}">리코더</a></li>
                            <li><a th:href="@{/class/classentertaionment}">피아노</a></li>
                            <li><a th:href="@{/class/classentertaionment}">바이올린</a></li>
                            <li><a th:href="@{/class/classentertaionment}">방송댄스</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </section>
    </div>

    <!-- 푸터 -->
    <div th:replace="~{/layout/footer :: footer}"></div>

</body>
<script src="http://code.jquery.com/jquery-1.9.0rc1.js"></script>
<script th:src="@{/js/motion.js}"></script>
<script th:src="@{/js/parent_main.js}"></script>
<script>
    const pageSize = 3;

    getList();

    function getList(page){
        $.ajax({
            method : 'get',
            url : '/rest/recommend',
            data : {
                page : page,
                size : pageSize
            },
            success:function (data){
                // 리스트 뿌려주는 함수.
                renderPro(data.content);
                renderPagination(data);
            },
            error:function (){
                console.error('실패')
            }
        })
    };

    function renderPro(pros){
        const proContainer = $('.pro_recommendation ul');
        proContainer.empty();

        pros.forEach(function(pro) {
            let boardRow =  `<li>
                <a href="#">
                    <img src="${pro.proProfileImageUrl}">
                        <p>${pro.proName}</p>
                        <div>
                            <p>후기</p>

                            <img src="../../images/${pro.averageRating > 2 ? 5 : 4.5}rating.png">
                                <p>(${pro.reviewCount})</p>
                        </div>
                </a>
            </li>`
            proContainer.append(boardRow);
        });
    }

    function renderPagination(pagination) {
        const paginationContainer = $('.pro_control');
        paginationContainer.empty();

        // 이전 버튼
        const prevDisabled = pagination.currentPage === 1 ? 'style = "pointer-events : none"' : '';
        paginationContainer.append(`
            <button type="button" ${prevDisabled}>
                <a class="page-link" data-page="${pagination.currentPage -1}">
                    <img src="/images/pro_button_pre.png" alt="이전 메뉴 보기">
                </a>
            </button>
        `);

        // 다음 버튼
        const nextDisabled = pagination.currentPage === pagination.totalPages ? 'style = "pointer-events : none"' : '';
        paginationContainer.append(`
            <button type="button" ${nextDisabled}>
                <a class="page-link" data-page="${pagination.currentPage +1}">
                    <img src="/images/pro_button_next.png" alt="다음 메뉴 보기">
                </a>
            </button>
        `);

        // 페이지 클릭했을 때 실행할 함수.
        $('.page-link').click(function(event) {
            event.preventDefault();
            const selectedPage = $(this).data('page');
            getList(selectedPage);
        });
    }
</script>

</html>